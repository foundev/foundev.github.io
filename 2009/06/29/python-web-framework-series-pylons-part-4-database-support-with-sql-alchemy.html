---
wordpress_id: 17
title: "Python Web Framework Series â€“ Pylons: Part 4 Introduction For Database Support With SQL Alchemy"
date: 2009-06-29T02:54:00+00:00
author: Ryan Svihla
layout: post
dsq_thread_id:
  - "425624187"
 tags:
  - python
---
<p>We last left off with <a href="/2009/06/25/python-web-framework-series-pylons-part-3-views-with-mako.html" target="_blank">Views with Mako</a>, now Pylons does not enforce on you an ORM at all, so you can use hand crafted SQL if you prefer. However, since I&rsquo;ve done enough of that for a career or two we&rsquo;re going to use my Python ORM of choice and the preferred one for Pylons SQLAlchemy. </p>
<h3>Where does SQLAlchemy fit in as an ORM?</h3>
<p>If you used NHibernate, you should feel pretty close to right at home with SQLAlchemy. If you come from an ActiveRecord, Entity Framework, Subsonic,&nbsp; or even Linq2Sql background this will be a bit more hand management than you are used to. If that is the case, I suggest&nbsp; <a href="http://elixir.ematia.de/trac/wiki" target="_blank">Elixir</a> (which I&rsquo;ve heard great things about) or <a href="http://www.sqlobject.org/" target="_blank">SQLObject</a> (which I&rsquo;ve used as well and works fine).</p>
<h3>Mapping and Setup</h3>
<p>There are three different ways to map tables to classes with SQLAlchemy, I will pick the most commonly used one, but will show the other two in a later post. In our PylonsForum project open <strong>model__init__.py&nbsp;</strong> and change the file to look like so:</p>
<p>&nbsp;</p>
<div style="padding-bottom: 0px;margin: 0px;padding-left: 0px;padding-right: 0px;float: none;padding-top: 0px" class="wlWriterEditableSmartContent">
  <div style="font-family:consolas,lucida console,courier,monospace">
    <span style="color: #ba2121"><i>&#8220;&#8221;&#8221;The&nbsp;application&#8217;s&nbsp;model&nbsp;objects&#8221;&#8221;&#8221;</i></span><br /> <span style="color: #008000"><b>from</b></span>&nbsp;<span style="color: #0000ff"><b>sqlalchemy</b></span>&nbsp;<span style="color: #008000"><b>import</b></span>&nbsp;orm<br /> <span style="color: #008000"><b>import</b></span>&nbsp;<span style="color: #0000ff"><b>sqlalchemy</b></span>&nbsp;<span style="color: #008000"><b>as</b></span>&nbsp;<span style="color: #0000ff"><b>sa</b></span><br /> <span style="color: #008000"><b>import</b></span>&nbsp;<span style="color: #0000ff"><b>datetime</b></span><br /> <span style="color: #008000"><b>from</b></span>&nbsp;<span style="color: #0000ff"><b>pylonsforum.model</b></span>&nbsp;<span style="color: #008000"><b>import</b></span>&nbsp;meta</p> 

    <p>
      <span style="color: #008000"><b>def</b></span>&nbsp;<span style="color: #0000ff">now</span>():<br /> &nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #008000"><b>return</b></span>&nbsp;datetime<span style="color: #666666">.</span>datetime<span style="color: #666666">.</span>now()
    </p>

    <p>
      <span style="color: #008000"><b>def</b></span>&nbsp;<span style="color: #0000ff">init_model</span>(engine):<br /> &nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #ba2121"><i>&#8220;&#8221;&#8221;Call&nbsp;me&nbsp;before&nbsp;using&nbsp;any&nbsp;of&nbsp;the&nbsp;tables&nbsp;or&nbsp;classes&nbsp;in&nbsp;the&nbsp;model&#8221;&#8221;&#8221;</i></span><br /> &nbsp;&nbsp;&nbsp;&nbsp;meta<span style="color: #666666">.</span>Session<span style="color: #666666">.</span>configure(bind<span style="color: #666666">=</span>engine)<br /> &nbsp;&nbsp;&nbsp;&nbsp;meta<span style="color: #666666">.</span>engine&nbsp;<span style="color: #666666">=</span>&nbsp;engine
    </p>

    <p>
      <span style="color: #008000"><b>class</b></span>&nbsp;<span style="color: #0000ff"><b>Post</b></span>(<span style="color: #008000">object</span>):<br /> &nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #008000"><b>pass</b></span>
    </p>

    <p>
      <span style="color: #008000"><b>class</b></span>&nbsp;<span style="color: #0000ff"><b>Thread</b></span>(<span style="color: #008000">object</span>):<br /> &nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #008000"><b>pass</b></span>
    </p>

    <p>
      posts_table&nbsp;<span style="color: #666666">=</span>&nbsp;sa<span style="color: #666666">.</span>Table(<span style="color: #ba2121">&#8220;posts&#8221;</span>,&nbsp;meta<span style="color: #666666">.</span>metadata,&nbsp;<br /> sa<span style="color: #666666">.</span>Column(<span style="color: #ba2121">&#8220;id&#8221;</span>,&nbsp;sa<span style="color: #666666">.</span>types<span style="color: #666666">.</span>Integer,&nbsp;primary_key<span style="color: #666666">=</span><span style="color: #008000">True</span>),<br /> sa<span style="color: #666666">.</span>Column(<span style="color: #ba2121">&#8220;threadid&#8221;</span>,&nbsp;sa<span style="color: #666666">.</span>types<span style="color: #666666">.</span>Integer,sa<span style="color: #666666">.</span>ForeignKey(<span style="color: #ba2121">&#8216;threads.id&#8217;</span>)),<br /> sa<span style="color: #666666">.</span>Column(<span style="color: #ba2121">&#8220;content&#8221;</span>,&nbsp;sa<span style="color: #666666">.</span>types<span style="color: #666666">.</span>String(<span style="color: #666666">4000</span>),&nbsp;nullable<span style="color: #666666">=</span><span style="color: #008000">False</span>),<br /> sa<span style="color: #666666">.</span>Column(<span style="color: #ba2121">&#8220;author&#8221;</span>,&nbsp;sa<span style="color: #666666">.</span>types<span style="color: #666666">.</span>String(<span style="color: #666666">255</span>),&nbsp;nullable<span style="color: #666666">=</span><span style="color: #008000">False</span>),<br /> sa<span style="color: #666666">.</span>Column(<span style="color: #ba2121">&#8220;created&#8221;</span>,&nbsp;sa<span style="color: #666666">.</span>types<span style="color: #666666">.</span>TIMESTAMP(),&nbsp;default<span style="color: #666666">=</span>now()),<br /> sa<span style="color: #666666">.</span>Column(<span style="color: #ba2121">&#8220;isparent&#8221;</span>&nbsp;,&nbsp;sa<span style="color: #666666">.</span>types<span style="color: #666666">.</span>Boolean,&nbsp;nullable<span style="color: #666666">=</span><span style="color: #008000">True</span>)<br /> )<br /> threads_table&nbsp;<span style="color: #666666">=</span>&nbsp;sa<span style="color: #666666">.</span>Table(<span style="color: #ba2121">&#8220;threads&#8221;</span>,&nbsp;meta<span style="color: #666666">.</span>metadata,<br /> sa<span style="color: #666666">.</span>Column(<span style="color: #ba2121">&#8220;id&#8221;</span>,&nbsp;sa<span style="color: #666666">.</span>types<span style="color: #666666">.</span>Integer,&nbsp;primary_key&nbsp;<span style="color: #666666">=</span>&nbsp;<span style="color: #008000">True</span>),<br /> sa<span style="color: #666666">.</span>Column(<span style="color: #ba2121">&#8220;subject&#8221;</span>,&nbsp;sa<span style="color: #666666">.</span>types<span style="color: #666666">.</span>String(<span style="color: #666666">255</span>)),</div> 

      <div style="font-family:consolas,lucida console,courier,monospace">
        sa.Column(<span style="color: #ba2121">&#8220;dateadded&#8221;</span>, sa.types.TIMESTAMP(), default=now())<br /> )<br /> orm<span style="color: #666666">.</span>mapper(Post,&nbsp;posts_table)<br /> orm<span style="color: #666666">.</span>mapper(Thread,&nbsp;threads_table,properties<span style="color: #666666">=</span>{<span style="color: #ba2121">&#8216;posts&#8217;</span>:orm<span style="color: #666666">.</span>relation(Post,&nbsp;backref<span style="color: #666666">=</span><span style="color: #ba2121">&#8216;thread&#8217;</span>)})
      </div></div>

<pre><code>  &lt;div style="padding-bottom: 0px;margin: 0px;padding-left: 0px;padding-right: 0px;float: none;padding-top: 0px" class="wlWriterEditableSmartContent"&gt;
    &lt;div style="font-family:consolas,lucida console,courier,monospace"&gt;
    &lt;/div&gt;
  &lt;/div&gt;

  &lt;p&gt;
    &amp;nbsp;
  &lt;/p&gt;

  &lt;p&gt;
    Not the best table structure and you&amp;rsquo;re welcome to improve this on your own but I wanted to create a default setup that was easy to read.&amp;nbsp; Lets take a bit to recap the pieces:
  &lt;/p&gt;

  &lt;hr /&gt;

  &lt;div style="padding-bottom: 0px;margin: 0px;padding-left: 0px;padding-right: 0px;float: none;padding-top: 0px" class="wlWriterEditableSmartContent"&gt;
    &lt;div style="font-family:consolas,lucida console,courier,monospace"&gt;
      &lt;span style="color: #008000"&gt;&lt;b&gt;def&lt;/b&gt;&lt;/span&gt;&amp;nbsp;&lt;span style="color: #0000ff"&gt;init_model&lt;/span&gt;(engine):&lt;br /&gt; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span style="color: #ba2121"&gt;&lt;i&gt;&amp;#8220;&amp;#8221;&amp;#8221;Call&amp;nbsp;me&amp;nbsp;before&amp;nbsp;using&amp;nbsp;any&amp;nbsp;of&amp;nbsp;the&amp;nbsp;tables&amp;nbsp;or&amp;nbsp;classes&amp;nbsp;in&amp;nbsp;the&amp;nbsp;model&amp;#8221;&amp;#8221;&amp;#8221;&lt;/i&gt;&lt;/span&gt;&lt;br /&gt; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;meta&lt;span style="color: #666666"&gt;.&lt;/span&gt;Session&lt;span style="color: #666666"&gt;.&lt;/span&gt;configure(bind&lt;span style="color: #666666"&gt;=&lt;/span&gt;engine)&lt;br /&gt; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;meta&lt;span style="color: #666666"&gt;.&lt;/span&gt;engine&amp;nbsp;&lt;span style="color: #666666"&gt;=&lt;/span&gt;&amp;nbsp;engine
    &lt;/div&gt;
  &lt;/div&gt;

  &lt;p&gt;
    Straightforward method here sets up a Session object with the database engine passed into the method.&amp;nbsp; Pylons will call init_model itself when the site is accessed.
  &lt;/p&gt;

  &lt;hr /&gt;

  &lt;div style="padding-bottom: 0px;margin: 0px;padding-left: 0px;padding-right: 0px;float: none;padding-top: 0px" class="wlWriterEditableSmartContent"&gt;
    &lt;div style="font-family:consolas,lucida console,courier,monospace"&gt;
      &lt;span style="color: #008000"&gt;&lt;b&gt;class&lt;/b&gt;&lt;/span&gt;&amp;nbsp;&lt;span style="color: #0000ff"&gt;&lt;b&gt;Post&lt;/b&gt;&lt;/span&gt;(&lt;span style="color: #008000"&gt;object&lt;/span&gt;):&lt;br /&gt; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span style="color: #008000"&gt;&lt;b&gt;pass&lt;/b&gt;&lt;/span&gt;&lt;/p&gt;

      &lt;p&gt;
        &lt;span style="color: #008000"&gt;&lt;b&gt;class&lt;/b&gt;&lt;/span&gt;&amp;nbsp;&lt;span style="color: #0000ff"&gt;&lt;b&gt;Thread&lt;/b&gt;&lt;/span&gt;(&lt;span style="color: #008000"&gt;object&lt;/span&gt;):&lt;br /&gt; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span style="color: #008000"&gt;&lt;b&gt;pass&lt;/b&gt;&lt;/span&gt; &lt;/div&gt; &lt;/div&gt;

        &lt;p&gt;
          So a couple of empty classes?&amp;nbsp; Python being a dynamic language can get away with this and just add the properties at runtime.&amp;nbsp; These are the objects we&amp;rsquo;ll be interacting with when we want to store data.
        &lt;/p&gt;

        &lt;hr /&gt;

        &lt;div style="padding-bottom: 0px;margin: 0px;padding-left: 0px;padding-right: 0px;float: none;padding-top: 0px" class="wlWriterEditableSmartContent"&gt;
          &lt;div style="font-family:consolas,lucida console,courier,monospace"&gt;
            posts_table&amp;nbsp;&lt;span style="color: #666666"&gt;=&lt;/span&gt;&amp;nbsp;sa&lt;span style="color: #666666"&gt;.&lt;/span&gt;Table(&lt;span style="color: #ba2121"&gt;&amp;#8220;posts&amp;#8221;&lt;/span&gt;,&amp;nbsp;meta&lt;span style="color: #666666"&gt;.&lt;/span&gt;metadata,&amp;nbsp;&lt;br /&gt; sa&lt;span style="color: #666666"&gt;.&lt;/span&gt;Column(&lt;span style="color: #ba2121"&gt;&amp;#8220;id&amp;#8221;&lt;/span&gt;,&amp;nbsp;sa&lt;span style="color: #666666"&gt;.&lt;/span&gt;types&lt;span style="color: #666666"&gt;.&lt;/span&gt;Integer,&amp;nbsp;primary_key&lt;span style="color: #666666"&gt;=&lt;/span&gt;&lt;span style="color: #008000"&gt;True&lt;/span&gt;),&lt;br /&gt; sa&lt;span style="color: #666666"&gt;.&lt;/span&gt;Column(&lt;span style="color: #ba2121"&gt;&amp;#8220;threadid&amp;#8221;&lt;/span&gt;,&amp;nbsp;sa&lt;span style="color: #666666"&gt;.&lt;/span&gt;types&lt;span style="color: #666666"&gt;.&lt;/span&gt;Integer,sa&lt;span style="color: #666666"&gt;.&lt;/span&gt;ForeignKey(&lt;span style="color: #ba2121"&gt;&amp;#8216;threads.id&amp;#8217;&lt;/span&gt;)),&lt;br /&gt; sa&lt;span style="color: #666666"&gt;.&lt;/span&gt;Column(&lt;span style="color: #ba2121"&gt;&amp;#8220;content&amp;#8221;&lt;/span&gt;,&amp;nbsp;sa&lt;span style="color: #666666"&gt;.&lt;/span&gt;types&lt;span style="color: #666666"&gt;.&lt;/span&gt;String(&lt;span style="color: #666666"&gt;4000&lt;/span&gt;),&amp;nbsp;nullable&lt;span style="color: #666666"&gt;=&lt;/span&gt;&lt;span style="color: #008000"&gt;False&lt;/span&gt;),&lt;br /&gt; sa&lt;span style="color: #666666"&gt;.&lt;/span&gt;Column(&lt;span style="color: #ba2121"&gt;&amp;#8220;author&amp;#8221;&lt;/span&gt;,&amp;nbsp;sa&lt;span style="color: #666666"&gt;.&lt;/span&gt;types&lt;span style="color: #666666"&gt;.&lt;/span&gt;String(&lt;span style="color: #666666"&gt;255&lt;/span&gt;),&amp;nbsp;nullable&lt;span style="color: #666666"&gt;=&lt;/span&gt;&lt;span style="color: #008000"&gt;False&lt;/span&gt;),&lt;br /&gt; sa&lt;span style="color: #666666"&gt;.&lt;/span&gt;Column(&lt;span style="color: #ba2121"&gt;&amp;#8220;dateadded&amp;#8221;&lt;/span&gt;,&amp;nbsp;sa&lt;span style="color: #666666"&gt;.&lt;/span&gt;types&lt;span style="color: #666666"&gt;.&lt;/span&gt;TIMESTAMP(),&amp;nbsp;default&lt;span style="color: #666666"&gt;=&lt;/span&gt;now()),&lt;br /&gt; sa&lt;span style="color: #666666"&gt;.&lt;/span&gt;Column(&lt;span style="color: #ba2121"&gt;&amp;#8220;isparent&amp;#8221;&lt;/span&gt;&amp;nbsp;,&amp;nbsp;sa&lt;span style="color: #666666"&gt;.&lt;/span&gt;types&lt;span style="color: #666666"&gt;.&lt;/span&gt;Boolean,&amp;nbsp;nullable&lt;span style="color: #666666"&gt;=&lt;/span&gt;&lt;span style="color: #008000"&gt;True&lt;/span&gt;)&lt;br /&gt; )&lt;br /&gt; threads_table&amp;nbsp;&lt;span style="color: #666666"&gt;=&lt;/span&gt;&amp;nbsp;sa&lt;span style="color: #666666"&gt;.&lt;/span&gt;Table(&lt;span style="color: #ba2121"&gt;&amp;#8220;threads&amp;#8221;&lt;/span&gt;,&amp;nbsp;meta&lt;span style="color: #666666"&gt;.&lt;/span&gt;metadata,&lt;br /&gt; sa&lt;span style="color: #666666"&gt;.&lt;/span&gt;Column(&lt;span style="color: #ba2121"&gt;&amp;#8220;id&amp;#8221;&lt;/span&gt;,&amp;nbsp;sa&lt;span style="color: #666666"&gt;.&lt;/span&gt;types&lt;span style="color: #666666"&gt;.&lt;/span&gt;Integer,&amp;nbsp;primary_key&amp;nbsp;&lt;span style="color: #666666"&gt;=&lt;/span&gt;&amp;nbsp;&lt;span style="color: #008000"&gt;True&lt;/span&gt;),&lt;br /&gt; sa&lt;span style="color: #666666"&gt;.&lt;/span&gt;Column(&lt;span style="color: #ba2121"&gt;&amp;#8220;subject&amp;#8221;&lt;/span&gt;,&amp;nbsp;sa&lt;span style="color: #666666"&gt;.&lt;/span&gt;types&lt;span style="color: #666666"&gt;.&lt;/span&gt;String(&lt;span style="color: #666666"&gt;255&lt;/span&gt;))&lt;br /&gt; )
          &lt;/div&gt;
        &lt;/div&gt;

        &lt;p&gt;
          Ok these table declarations are providing the data definition logic, including some basic relationship, nothing too interesting here post in comments if you have specific questions.
        &lt;/p&gt;

        &lt;hr /&gt;

        &lt;div style="padding-bottom: 0px;margin: 0px;padding-left: 0px;padding-right: 0px;float: none;padding-top: 0px" class="wlWriterEditableSmartContent"&gt;
          &lt;div style="font-family:consolas,lucida console,courier,monospace"&gt;
            orm&lt;span style="color: #666666"&gt;.&lt;/span&gt;mapper(Post,&amp;nbsp;posts_table)&lt;br /&gt; orm&lt;span style="color: #666666"&gt;.&lt;/span&gt;mapper(Thread,&amp;nbsp;threads_table,properties&lt;span style="color: #666666"&gt;=&lt;/span&gt;{&lt;span style="color: #ba2121"&gt;&amp;#8216;posts&amp;#8217;&lt;/span&gt;:orm&lt;span style="color: #666666"&gt;.&lt;/span&gt;relation(Post,&amp;nbsp;backref&lt;span style="color: #666666"&gt;=&lt;/span&gt;&lt;span style="color: #ba2121"&gt;&amp;#8216;thread&amp;#8217;&lt;/span&gt;)})
          &lt;/div&gt;
        &lt;/div&gt;

        &lt;p&gt;
          Here the orm.mapper calls take the Page and Thread classes and map them with the table data definitions typed in earlier.&amp;nbsp; You can also specify relationships here as we have done in the thread mapping, the properties argument is referencing the &lt;i&gt;Post&lt;/i&gt; class and mapping it to a property called posts on the &lt;i&gt;Thread&lt;/i&gt; class, while also mapping the other direction and putting thread on the &lt;i&gt;Post&lt;/i&gt; class.
        &lt;/p&gt;

        &lt;hr /&gt;

        &lt;p&gt;
          Finally run &lt;i&gt;paster setup-app development.ini&lt;/i&gt; from the root pylonsforum directory and you should see a bunch of SQL flying by which indicates it has build the database schema for us:
        &lt;/p&gt;

        &lt;p&gt;
          &lt;a href="//lostechies.com/ryansvihla/files/2011/03/image_3D5BCA36.png"&gt;&lt;img style="border-right-width: 0px;border-top-width: 0px;border-bottom-width: 0px;border-left-width: 0px" alt="image" src="//lostechies.com/ryansvihla/files/2011/03/image_thumb_214D9BFC.png" width="609" border="0" height="420" /&gt;&lt;/a&gt;
        &lt;/p&gt;

        &lt;h3&gt;
          Making Our New Thread Store In The Database
        &lt;/h3&gt;

        &lt;p&gt;
          In the interest of space and time I&amp;rsquo;ll skip the testing story for another post.&amp;nbsp;
        &lt;/p&gt;

        &lt;p&gt;
          Open up &lt;i&gt;controllershome.py&lt;/i&gt; .
        &lt;/p&gt;

        &lt;ul&gt;
          &lt;li&gt;
            Remove the Post class we created several posts ago
          &lt;/li&gt;
          &lt;li&gt;
            under the imports add &lt;i&gt;import pylonsforum.model as model &lt;/i&gt;
          &lt;/li&gt;
          &lt;li&gt;
            under the imports add &lt;i&gt;import pylonsforum.model.meta as meta&lt;/i&gt;
          &lt;/li&gt;
          &lt;li&gt;
            change the submitnewthread method to the following &lt;ul&gt;
              &lt;div style="padding-bottom: 0px;margin: 0px;padding-left: 0px;padding-right: 0px;float: none;padding-top: 0px" class="wlWriterEditableSmartContent"&gt;
                &lt;div style="font-family:consolas,lucida console,courier,monospace"&gt;
                  thread&amp;nbsp;&lt;span style="color: #666666"&gt;=&lt;/span&gt;&amp;nbsp;model&lt;span style="color: #666666"&gt;.&lt;/span&gt;Thread()&amp;nbsp;&lt;br /&gt; thread&lt;span style="color: #666666"&gt;.&lt;/span&gt;subject&amp;nbsp;&lt;span style="color: #666666"&gt;=&lt;/span&gt;&amp;nbsp;request&lt;span style="color: #666666"&gt;.&lt;/span&gt;POST[&lt;span style="color: #ba2121"&gt;&amp;#8216;subject&amp;#8217;&lt;/span&gt;]&lt;br /&gt; post&amp;nbsp;&lt;span style="color: #666666"&gt;=&lt;/span&gt;&amp;nbsp;model&lt;span style="color: #666666"&gt;.&lt;/span&gt;Post()&lt;br /&gt; post&lt;span style="color: #666666"&gt;.&lt;/span&gt;author&amp;nbsp;&lt;span style="color: #666666"&gt;=&lt;/span&gt;users&lt;span style="color: #666666"&gt;.&lt;/span&gt;get_current_user(&lt;span style="color: #008000"&gt;self&lt;/span&gt;)&lt;br /&gt; post&lt;span style="color: #666666"&gt;.&lt;/span&gt;isparent&amp;nbsp;&lt;span style="color: #666666"&gt;=&lt;/span&gt;&amp;nbsp;&lt;span style="color: #008000"&gt;True&lt;/span&gt;&lt;br /&gt; post&lt;span style="color: #666666"&gt;.&lt;/span&gt;content&amp;nbsp;&lt;span style="color: #666666"&gt;=&lt;/span&gt;&amp;nbsp;request&lt;span style="color: #666666"&gt;.&lt;/span&gt;POST[&lt;span style="color: #ba2121"&gt;&amp;#8216;content&amp;#8217;&lt;/span&gt;]&lt;br /&gt; thread&lt;span style="color: #666666"&gt;.&lt;/span&gt;posts&lt;span style="color: #666666"&gt;.&lt;/span&gt;append(post)&amp;nbsp;&lt;span style="color: #408080"&gt;&lt;i&gt;#adding&amp;nbsp;post&amp;nbsp;to&amp;nbsp;the&amp;nbsp;thread&amp;nbsp;object&lt;/i&gt;&lt;/span&gt;&lt;br /&gt; meta&lt;span style="color: #666666"&gt;.&lt;/span&gt;Session&lt;span style="color: #666666"&gt;.&lt;/span&gt;add(thread)&amp;nbsp;&lt;span style="color: #408080"&gt;&lt;i&gt;#look&amp;nbsp;only&amp;nbsp;have&amp;nbsp;to&amp;nbsp;add&amp;nbsp;the&amp;nbsp;thread&amp;nbsp;object&lt;/i&gt;&lt;/span&gt;&lt;br /&gt; meta&lt;span style="color: #666666"&gt;.&lt;/span&gt;Session&lt;span style="color: #666666"&gt;.&lt;/span&gt;flush()&amp;nbsp;&lt;span style="color: #408080"&gt;&lt;i&gt;#optional&amp;nbsp;when&amp;nbsp;AutoCommit&amp;nbsp;is&amp;nbsp;on,&amp;nbsp;but&amp;nbsp;useful&amp;nbsp;for&amp;nbsp;control&amp;nbsp;in&amp;nbsp;data&amp;nbsp;integrity&amp;nbsp;cases&lt;/i&gt;&lt;/span&gt;&lt;br /&gt; meta&lt;span style="color: #666666"&gt;.&lt;/span&gt;Session&lt;span style="color: #666666"&gt;.&lt;/span&gt;commit()&amp;nbsp;&lt;span style="color: #408080"&gt;&lt;i&gt;#makes&amp;nbsp;changes&amp;nbsp;real&lt;/i&gt;&lt;/span&gt;&lt;br /&gt; thread_query&amp;nbsp;&lt;span style="color: #666666"&gt;=&lt;/span&gt;&amp;nbsp;meta&lt;span style="color: #666666"&gt;.&lt;/span&gt;Session&lt;span style="color: #666666"&gt;.&lt;/span&gt;query(model&lt;span style="color: #666666"&gt;.&lt;/span&gt;Thread)&amp;nbsp;&lt;span style="color: #408080"&gt;&lt;i&gt;#query&amp;nbsp;back&amp;nbsp;submitted&amp;nbsp;data&amp;nbsp;to&amp;nbsp;display&amp;nbsp;to&amp;nbsp;ui&lt;/i&gt;&lt;/span&gt;&lt;br /&gt; thread&amp;nbsp;&lt;span style="color: #666666"&gt;=&lt;/span&gt;&amp;nbsp;thread_query&lt;span style="color: #666666"&gt;.&lt;/span&gt;filter_by(&lt;span style="color: #008000"&gt;id&lt;/span&gt;&lt;span style="color: #666666"&gt;=&lt;/span&gt;thread&lt;span style="color: #666666"&gt;.&lt;/span&gt;id)&lt;span style="color: #666666"&gt;.&lt;/span&gt;first()&amp;nbsp;&lt;span style="color: #408080"&gt;&lt;i&gt;#&amp;nbsp;yes&amp;nbsp;actually&amp;nbsp;querying&amp;nbsp;using&amp;nbsp;the&amp;nbsp;thread&amp;nbsp;id&amp;nbsp;of&amp;nbsp;our&amp;nbsp;created&amp;nbsp;object&amp;nbsp;above&lt;/i&gt;&lt;/span&gt;&lt;br /&gt; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;c&lt;span style="color: #666666"&gt;.&lt;/span&gt;username&amp;nbsp;&lt;span style="color: #666666"&gt;=&lt;/span&gt;&amp;nbsp;thread&lt;span style="color: #666666"&gt;.&lt;/span&gt;posts[&lt;span style="color: #666666"&gt;&lt;/span&gt;]&lt;span style="color: #666666"&gt;.&lt;/span&gt;author&lt;br /&gt; c&lt;span style="color: #666666"&gt;.&lt;/span&gt;subject&amp;nbsp;&lt;span style="color: #666666"&gt;=&lt;/span&gt;&amp;nbsp;thread&lt;span style="color: #666666"&gt;.&lt;/span&gt;subject&lt;br /&gt; c&lt;span style="color: #666666"&gt;.&lt;/span&gt;content&amp;nbsp;&lt;span style="color: #666666"&gt;=&lt;/span&gt;&amp;nbsp;thread&lt;span style="color: #666666"&gt;.&lt;/span&gt;posts[&lt;span style="color: #666666"&gt;&lt;/span&gt;]&lt;span style="color: #666666"&gt;.&lt;/span&gt;content&lt;br /&gt; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span style="color: #008000"&gt;&lt;b&gt;return&lt;/b&gt;&lt;/span&gt;&amp;nbsp;render(&lt;span style="color: #ba2121"&gt;&amp;#8216;submitnewthread.mako&amp;#8217;&lt;/span&gt;)
                &lt;/div&gt;
              &lt;/div&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;

        &lt;p&gt;
          Finally run the newthread action
        &lt;/p&gt;

        &lt;p&gt;
          &amp;nbsp; &lt;a href="http://localhost:5000/home/newthread" target="_blank"&gt;http://localhost:5000/home/newthread&lt;/a&gt;
        &lt;/p&gt;

        &lt;p&gt;
          then create a thread
        &lt;/p&gt;

        &lt;p&gt;
          &lt;a title="http://localhost:5000/home/submitnewthread" href="http://localhost:5000/home/submitnewthread"&gt;http://localhost:5000/home/submitnewthread&lt;/a&gt;
        &lt;/p&gt;

        &lt;p&gt;
          Should be no change in the actual outward appearance of from what we were doing before.
        &lt;/p&gt;

        &lt;h3&gt;
        &lt;/h3&gt;

        &lt;h3&gt;
          Summary and Recap
        &lt;/h3&gt;

        &lt;p&gt;
          This was a very quick and basic introduction to SQLAlchemy and I will do more with it over the next couple of posts, but please add any comments to things I did not make clear. SQLAlchemy and ORM&amp;rsquo;s in general are a very large subjects and those of us that have used them for a long time tend to forget not all of this was so obvious when we started.
        &lt;/p&gt;
</code></pre>