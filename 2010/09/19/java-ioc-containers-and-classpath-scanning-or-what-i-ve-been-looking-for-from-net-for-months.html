<hr />
<p>wordpress_id: 47
title: Java IoC containers and classpath scanning (or what Iâ€™ve been looking for from .NET for months)
date: 2010-09-19T19:01:00+00:00
author: Ryan Svihla
layout: post
wordpress_guid: /blogs/rssvihla/archive/2010/09/19/java-ioc-containers-and-classpath-scanning-or-what-i-ve-been-looking-for-from-net-for-months.aspx
dsq_thread_id:
  - "425624466"
tags:
  - IoC
  - Java
  - Spring
redirect_from: "/blogs/rssvihla/archive/2010/09/19/java-ioc-containers-and-classpath-scanning-or-what-i-ve-been-looking-for-from-net-for-months.aspx/"</p>
<hr />
<p>Frustrated with the typical way I saw IoC used in Java where every example I found involved thousands of lines of XML <br />
and/or Java code to configure Java beans or components.&#160; This is very different than IoC typically used in .NET where most IoC containers allow <br />
you to "autowire" in their terminology up every class in an assembly with a couple of lines of code.&#160; Having been coding in that fashion <br />
for several years in .NET I was dismayed when none of my fellow Java coders that I worked with or knew personally had any concept <br />
of the equivalent functionality, and instead informed me the IDE would be my help in maintaining these massive XML files. </p>
<p>Not content with their answers I burrowed into Spring, Guice and PicoContainer docs and found "classpath scanning" which is roughly <br />
equivalent to "autowire" in .NET. Below is an example of this in Spring 3:</p>
<p>MyStuff.java (my main class note his has 2 dependencies which you can view on my <a href="https://github.com/rssvihla/SpringDemo/tree/master/src/org/foo" target="_blank">github repo</a>)</p>
<div style="padding-bottom: 0px;margin: 0px;padding-left: 0px;padding-right: 0px;float: none;padding-top: 0px" class="wlWriterEditableSmartContent">
  <div style="font-family:consolas,lucida console,courier,monospace">
    <span style="color:#008000"><b>package</b></span>&#160;org<span style="color:#666666">.</span><span style="color:#7D9029">foo</span><span style="color:#666666">;</span></p> 

    <p>
      <span style="color:#008000"><b>import</b></span>&#160;<span style="color:#0000FF"><b>org.springframework.beans.factory.annotation.Autowired</b></span><span style="color:#666666">;</span><br /> <span style="color:#008000"><b>import</b></span>&#160;<span style="color:#0000FF"><b>org.springframework.stereotype.Service</b></span><span style="color:#666666">;</span>
    </p>

    <p>
      <span style="color:#AA22FF">@Service</span>&#160;<span style="color:#408080"><i>//one&#160;way&#160;of&#160;marking&#160;this&#160;as&#160;a&#160;component&#160;to&#160;register<br /> </i></span><span style="color:#008000"><b>public</b></span>&#160;<span style="color:#008000"><b>class</b></span>&#160;<span style="color:#0000FF"><b>MyStuff</b></span>&#160;<span style="color:#666666">{</span><br /> &#160;&#160;&#160;&#160;<span style="color:#008000"><b>private</b></span>&#160;<span style="color:#008000"><b>final</b></span>&#160;DependencyWithNoInterface&#160;first<span style="color:#666666">;</span><br /> &#160;&#160;&#160;&#160;<span style="color:#008000"><b>private</b></span>&#160;<span style="color:#008000"><b>final</b></span>&#160;DependencyInterface&#160;second<span style="color:#666666">;</span>
    </p>

    <p>
      &#160;&#160;&#160;&#160;<span style="color:#AA22FF">@Autowired</span>&#160;<span style="color:#408080"><i>//tells&#160;spring&#160;which&#160;constructor&#160;to&#160;use&#160;for&#160;it&#8217;s&#160;dependencies<br /> </i></span>&#160;&#160;&#160;&#160;<span style="color:#008000"><b>public</b></span>&#160;<span style="color:#0000FF">MyStuff</span><span style="color:#666666">(</span>DependencyWithNoInterface&#160;first<span style="color:#666666">,</span>&#160;DependencyInterface&#160;second<span style="color:#666666">)</span>&#160;<span style="color:#666666">{</span>
    </p>

    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span style="color:#008000"><b>this</b></span><span style="color:#666666">.</span><span style="color:#7D9029">first</span>&#160;<span style="color:#666666">=</span>&#160;first<span style="color:#666666">;</span><br /> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span style="color:#008000"><b>this</b></span><span style="color:#666666">.</span><span style="color:#7D9029">second</span>&#160;<span style="color:#666666">=</span>&#160;second<span style="color:#666666">;</span><br /> &#160;&#160;&#160;&#160;<span style="color:#666666">}</span>
    </p>

    <p>
      &#160;&#160;&#160;&#160;<span style="color:#008000"><b>public</b></span>&#160;<span style="color:#B00040">void</span>&#160;<span style="color:#0000FF">run</span><span style="color:#666666">(){</span><br /> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;System<span style="color:#666666">.</span><span style="color:#7D9029">out</span><span style="color:#666666">.</span><span style="color:#7D9029">println</span><span style="color:#666666">(</span><span style="color:#BA2121">&#8220;foo&#160;me&#8221;</span><span style="color:#666666">);</span><br /> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;first<span style="color:#666666">.</span><span style="color:#7D9029">foo</span><span style="color:#666666">();</span><br /> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;second<span style="color:#666666">.</span><span style="color:#7D9029">superFoo</span><span style="color:#666666">();</span><br /> &#160;&#160;&#160;&#160;<span style="color:#666666">}</span><br /> <span style="color:#666666">}</span> </div> </div>

<pre><code>  &lt;p&gt;
    appContext.xml (seems you still need some XML)
  &lt;/p&gt;

  &lt;div style="padding-bottom: 0px;margin: 0px;padding-left: 0px;padding-right: 0px;float: none;padding-top: 0px" class="wlWriterEditableSmartContent"&gt;
    &lt;div style="font-family:consolas,lucida console,courier,monospace"&gt;
      &lt;span style="color:#BC7A00"&gt;&lt;?xml&amp;#160;version=&amp;#8221;1.0&amp;#8243;&amp;#160;encoding=&amp;#8221;UTF-8&amp;#8243;?&gt;&lt;/span&gt;&lt;br /&gt; &lt;span style="color:#008000"&gt;&lt;b&gt;&lt;beans&lt;/b&gt;&lt;/span&gt;&amp;#160;&lt;span style="color:#7D9029"&gt;xmlns=&lt;/span&gt;&lt;span style="color:#BA2121"&gt;&amp;#8220;http://www.springframework.org/schema/beans&amp;#8221;&lt;/span&gt;&lt;br /&gt; &amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&lt;span style="color:#7D9029"&gt;xmlns:xsi=&lt;/span&gt;&lt;span style="color:#BA2121"&gt;&amp;#8220;http://www.w3.org/2001/XMLSchema-instance&amp;#8221;&lt;/span&gt;&lt;br /&gt; &amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&lt;span style="color:#7D9029"&gt;xmlns:context=&lt;/span&gt;&lt;span style="color:#BA2121"&gt;&amp;#8220;http://www.springframework.org/schema/context&amp;#8221;&lt;/span&gt;&lt;br /&gt; &amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&lt;span style="color:#7D9029"&gt;xsi:schemaLocation=&lt;/span&gt;&lt;span style="color:#BA2121"&gt;&amp;#8220;http://www.springframework.org/schema/beans&lt;br /&gt; &amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;http://www.springframework.org/schema/beans/spring-beans-3.0.xsd&lt;br /&gt; &amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;http://www.springframework.org/schema/context&lt;br /&gt; &amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;http://www.springframework.org/schema/context/spring-context-3.0.xsd&amp;#8221;&lt;/span&gt;&lt;span style="color:#008000"&gt;&lt;b&gt;&gt;&lt;/b&gt;&lt;/span&gt;&lt;br /&gt; &amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&lt;span style="color:#008000"&gt;&lt;b&gt;&lt;context:component-scan&lt;/b&gt;&lt;/span&gt;&amp;#160;&lt;span style="color:#7D9029"&gt;base-package=&lt;/span&gt;&lt;span style="color:#BA2121"&gt;&amp;#8220;org.foo&amp;#8221;&lt;/span&gt;&lt;span style="color:#008000"&gt;&lt;b&gt;/&gt;&lt;/b&gt;&lt;/span&gt;&lt;br /&gt; &lt;span style="color:#008000"&gt;&lt;b&gt;&lt;/beans&gt;&lt;/b&gt;&lt;/span&gt;
    &lt;/div&gt;
  &lt;/div&gt;

  &lt;p&gt;
    Application.java (the initialization)
  &lt;/p&gt;

  &lt;div style="padding-bottom: 0px;margin: 0px;padding-left: 0px;padding-right: 0px;float: none;padding-top: 0px" class="wlWriterEditableSmartContent"&gt;
    &lt;div style="font-family:consolas,lucida console,courier,monospace"&gt;
      &lt;span style="color:#008000"&gt;&lt;b&gt;package&lt;/b&gt;&lt;/span&gt;&amp;#160;org&lt;span style="color:#666666"&gt;.&lt;/span&gt;&lt;span style="color:#7D9029"&gt;foo&lt;/span&gt;&lt;span style="color:#666666"&gt;;&lt;/span&gt;&lt;/p&gt;

      &lt;p&gt;
        &lt;span style="color:#008000"&gt;&lt;b&gt;import&lt;/b&gt;&lt;/span&gt;&amp;#160;&lt;span style="color:#0000FF"&gt;&lt;b&gt;org.springframework.context.ApplicationContext&lt;/b&gt;&lt;/span&gt;&lt;span style="color:#666666"&gt;;&lt;/span&gt;&lt;br /&gt; &lt;span style="color:#008000"&gt;&lt;b&gt;import&lt;/b&gt;&lt;/span&gt;&amp;#160;&lt;span style="color:#0000FF"&gt;&lt;b&gt;org.springframework.context.support.ClassPathXmlApplicationContext&lt;/b&gt;&lt;/span&gt;&lt;span style="color:#666666"&gt;;&lt;/span&gt;
      &lt;/p&gt;

      &lt;p&gt;
        &lt;span style="color:#008000"&gt;&lt;b&gt;public&lt;/b&gt;&lt;/span&gt;&amp;#160;&lt;span style="color:#008000"&gt;&lt;b&gt;class&lt;/b&gt;&lt;/span&gt;&amp;#160;&lt;span style="color:#0000FF"&gt;&lt;b&gt;Application&lt;/b&gt;&lt;/span&gt;&amp;#160;&lt;span style="color:#666666"&gt;{&lt;/span&gt;&lt;br /&gt; &amp;#160;&amp;#160;&amp;#160;&amp;#160;&lt;span style="color:#008000"&gt;&lt;b&gt;public&lt;/b&gt;&lt;/span&gt;&amp;#160;&lt;span style="color:#008000"&gt;&lt;b&gt;static&lt;/b&gt;&lt;/span&gt;&amp;#160;&lt;span style="color:#B00040"&gt;void&lt;/span&gt;&amp;#160;&lt;span style="color:#0000FF"&gt;main&lt;/span&gt;&lt;span style="color:#666666"&gt;(&lt;/span&gt;String&amp;#160;args&lt;span style="color:#666666"&gt;[]){&lt;/span&gt;&lt;br /&gt; &amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;ApplicationContext&amp;#160;ctx&amp;#160;&lt;span style="color:#666666"&gt;=&lt;/span&gt;&amp;#160;&amp;#160;&amp;#160;&lt;span style="color:#008000"&gt;&lt;b&gt;new&lt;/b&gt;&lt;/span&gt;&amp;#160;ClassPathXmlApplicationContext&lt;span style="color:#666666"&gt;(&lt;/span&gt;&lt;span style="color:#BA2121"&gt;&amp;#8220;appContext.xml&amp;#8221;&lt;/span&gt;&lt;span style="color:#666666"&gt;);&lt;/span&gt;&amp;#160;&lt;span style="color:#408080"&gt;&lt;i&gt;//the&amp;#160;IoC&amp;#160;container&lt;br /&gt; &lt;/i&gt;&lt;/span&gt;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;MyStuff&amp;#160;stff&amp;#160;&lt;span style="color:#666666"&gt;=&lt;/span&gt;&amp;#160;ctx&lt;span style="color:#666666"&gt;.&lt;/span&gt;&lt;span style="color:#7D9029"&gt;getBean&lt;/span&gt;&lt;span style="color:#666666"&gt;(&lt;/span&gt;MyStuff&lt;span style="color:#666666"&gt;.&lt;/span&gt;&lt;span style="color:#7D9029"&gt;class&lt;/span&gt;&lt;span style="color:#666666"&gt;);&lt;/span&gt;&amp;#160;&lt;span style="color:#408080"&gt;&lt;i&gt;//my&amp;#160;fully&amp;#160;injected&amp;#160;class&lt;br /&gt; &lt;/i&gt;&lt;/span&gt;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;stff&lt;span style="color:#666666"&gt;.&lt;/span&gt;&lt;span style="color:#7D9029"&gt;run&lt;/span&gt;&lt;span style="color:#666666"&gt;();&lt;/span&gt;&lt;br /&gt; &amp;#160;&amp;#160;&amp;#160;&amp;#160;&lt;span style="color:#666666"&gt;}&lt;/span&gt;&lt;br /&gt; &lt;span style="color:#666666"&gt;}&lt;/span&gt; &lt;/div&gt; &lt;/div&gt;

        &lt;p&gt;
          &amp;#160;
        &lt;/p&gt;

        &lt;p&gt;
          &amp;#160;
        &lt;/p&gt;

        &lt;p&gt;
          Now Iâ€™m sure for the .NET developers familiar with StructureMap, Windsor, Autofac, etc this is completely unimpressive. Iâ€™m also sure there are Java developers that are somewhat unimpressed with this but for reasons that involve holding onto giant configuration artifacts. &lt;strong&gt;Manual IoC component registration falls where hand writing SQL for trivial data access does for me, extra repetitive work that has been solved years ago&lt;/strong&gt;.
        &lt;/p&gt;

        &lt;p&gt;
          Edit:
        &lt;/p&gt;

        &lt;p&gt;
          It appears you can forgo XML as well in your main class use a different Application context and add the refresh and scan lines
        &lt;/p&gt;

        &lt;div style="padding-bottom: 0px;margin: 0px;padding-left: 0px;padding-right: 0px;float: none;padding-top: 0px" class="wlWriterSmartContent"&gt;
          &lt;div style="font-family: consolas,lucida console,courier,monospace"&gt;
            &lt;span style="color: #008000"&gt;&lt;b&gt;package&lt;/b&gt;&lt;/span&gt; org&lt;span style="color: #666666"&gt;.&lt;/span&gt;&lt;span style="color: #7d9029"&gt;foo&lt;/span&gt;&lt;span style="color: #666666"&gt;;&lt;/span&gt; &lt;/p&gt;

            &lt;p&gt;
              &lt;span style="color: #008000"&gt;&lt;b&gt;import&lt;/b&gt;&lt;/span&gt;&amp;#160;&lt;span style="color: #0000ff"&gt;&lt;b&gt;org.springframework.context.annotation.AnnotationConfigApplicationContext&lt;/b&gt;&lt;/span&gt;&lt;span style="color: #666666"&gt;;&lt;/span&gt;
            &lt;/p&gt;

            &lt;p&gt;
              &lt;span style="color: #008000"&gt;&lt;b&gt;public&lt;/b&gt;&lt;/span&gt;&amp;#160;&lt;span style="color: #008000"&gt;&lt;b&gt;class&lt;/b&gt;&lt;/span&gt;&amp;#160;&lt;span style="color: #0000ff"&gt;&lt;b&gt;Application&lt;/b&gt;&lt;/span&gt;&amp;#160;&lt;span style="color: #666666"&gt;{&lt;/span&gt; &lt;br /&gt;&amp;#160;&amp;#160;&amp;#160; &lt;span style="color: #008000"&gt;&lt;b&gt;public&lt;/b&gt;&lt;/span&gt;&amp;#160;&lt;span style="color: #008000"&gt;&lt;b&gt;static&lt;/b&gt;&lt;/span&gt;&amp;#160;&lt;span style="color: #b00040"&gt;void&lt;/span&gt;&amp;#160;&lt;span style="color: #0000ff"&gt;main&lt;/span&gt;&lt;span style="color: #666666"&gt;(&lt;/span&gt;String args&lt;span style="color: #666666"&gt;[]){&lt;/span&gt; &lt;br /&gt;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160; AnnotationConfigApplicationContext ctx &lt;span style="color: #666666"&gt;=&lt;/span&gt;&amp;#160;&amp;#160; &lt;span style="color: #008000"&gt;&lt;b&gt;new&lt;/b&gt;&lt;/span&gt; AnnotationConfigApplicationContext&lt;span style="color: #666666"&gt;();&lt;/span&gt;&amp;#160; &lt;br /&gt;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160; ctx&lt;span style="color: #666666"&gt;.&lt;/span&gt;&lt;span style="color: #7d9029"&gt;scan&lt;/span&gt;&lt;span style="color: #666666"&gt;(&lt;/span&gt;&lt;span style="color: #ba2121"&gt;"org.foo"&lt;/span&gt;&lt;span style="color: #666666"&gt;);&lt;/span&gt;&amp;#160;&lt;span style="color: #408080"&gt;&lt;i&gt;//scans the org.foo package &lt;br /&gt;&lt;/i&gt;&lt;/span&gt;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160; ctx&lt;span style="color: #666666"&gt;.&lt;/span&gt;&lt;span style="color: #7d9029"&gt;refresh&lt;/span&gt;&lt;span style="color: #666666"&gt;();&lt;/span&gt;&amp;#160;&lt;span style="color: #408080"&gt;&lt;i&gt;//needed to load them for some reason &lt;br /&gt;&lt;/i&gt;&lt;/span&gt;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160; MyStuff stff &lt;span style="color: #666666"&gt;=&lt;/span&gt; ctx&lt;span style="color: #666666"&gt;.&lt;/span&gt;&lt;span style="color: #7d9029"&gt;getBean&lt;/span&gt;&lt;span style="color: #666666"&gt;(&lt;/span&gt;MyStuff&lt;span style="color: #666666"&gt;.&lt;/span&gt;&lt;span style="color: #7d9029"&gt;class&lt;/span&gt;&lt;span style="color: #666666"&gt;);&lt;/span&gt; &lt;br /&gt;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160; stff&lt;span style="color: #666666"&gt;.&lt;/span&gt;&lt;span style="color: #7d9029"&gt;run&lt;/span&gt;&lt;span style="color: #666666"&gt;();&lt;/span&gt; &lt;br /&gt;&amp;#160;&amp;#160;&amp;#160; &lt;span style="color: #666666"&gt;}&lt;/span&gt; &lt;br /&gt;&lt;span style="color: #666666"&gt;}&lt;/span&gt; &lt;/div&gt;
            &lt;/p&gt;
          &lt;/div&gt;
</code></pre>